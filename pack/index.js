!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,n){var r=t.call(this,n)||this;return r.name="Warp Server Error",r.code=e,r}return i(e,t),Object.defineProperty(e,"Code",{get:function(){return Object.freeze({MissingConfiguration:300,InternalServerError:100,QueryError:101,InvalidCredentials:102,InvalidSessionToken:103,InvalidObjectKey:104,InvalidPointer:105,ForbiddenOperation:106,UsernameTaken:107,EmailTaken:108,InvalidAPIKey:109,ModelNotFound:110,FunctionNotFound:111,RequestTimeout:112,FunctionError:113,TooManyRequests:114,DatabaseError:115})},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Status",{get:function(){return Object.freeze({ServerError:400,Unauthorized:401,Forbidden:403,NotFound:404,RequestTimeout:408,TooManyRequests:429})},enumerable:!0,configurable:!0}),e.prototype.statics=function(){return this.constructor},Object.defineProperty(e.prototype,"status",{get:function(){return this.code===this.statics().Code.InvalidCredentials||this.code===this.statics().Code.InvalidSessionToken||this.code===this.statics().Code.UsernameTaken||this.code===this.statics().Code.EmailTaken?this.statics().Status.Unauthorized:this.code===this.statics().Code.ForbiddenOperation?this.statics().Status.Forbidden:this.code===this.statics().Code.ModelNotFound||this.code===this.statics().Code.FunctionNotFound?this.statics().Status.NotFound:this.code===this.statics().Code.RequestTimeout?this.statics().Status.RequestTimeout:this.code===this.statics().Code.TooManyRequests?this.statics().Status.TooManyRequests:this.statics().Status.ServerError},enumerable:!0,configurable:!0}),e}(Error);e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InternalKeys=Object.freeze({Id:"id",Timestamps:Object.freeze({CreatedAt:"created_at",UpdatedAt:"updated_at",DeletedAt:"deleted_at"}),Auth:Object.freeze({User:"user",Username:"username",Email:"email",Password:"password",Session:"session",Origin:"origin",SessionToken:"session_token",RevokedAt:"revoked_at"}),Pointers:Object.freeze({LegacyClassName:"className",ClassName:"class_name",Attributes:"attributes"})}),e.Defaults=Object.freeze({Query:Object.freeze({Sort:[e.InternalKeys.Id],Skip:0,Limit:100})})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};const i={Void:t=>void 0===t,Null:t=>null===t,String:t=>"string"==typeof t,Number:t=>"number"==typeof t,Boolean:t=>typeof t==typeof!0,Array:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(t=>t instanceof Array),Object:t=>typeof t==typeof{}&&!(t instanceof Array),Function:t=>"function"==typeof t,Class:(t,e)=>t instanceof e},s={"an optional string":t=>i.Void(t)||i.String(t),"a string":t=>i.String(t),"an optional number":t=>i.Void(t)||i.Number(t),"a number":t=>i.Number(t),"an optional boolean":t=>i.Void(t)||i.Boolean(t),"a boolean":t=>i.Boolean(t),"an optional array":t=>i.Void(t)||i.Array(t),"an array":t=>i.Array(t),"an optional object":t=>i.Void(t)||i.Object(t),"an object":t=>i.Object(t),"any value":()=>!0,"a value":t=>!i.Void(t),"an optional function":t=>i.Void(t)||i.Function(t),"a function":t=>i.Function(t)},o=[[/^with \d{1,} to \d{1,} characters$/i,(t,e)=>{const n=parseInt(e.slice("with ".length-1,e.indexOf(" to"))),r=parseInt(e.slice(e.indexOf("to")+"to ".length));return t.length>=n&&t.length<=r}],[/^with \d{1,} or more characters$/i,(t,e)=>{const n=parseInt(e.slice("with ".length-1,e.indexOf(" to")));return t.length>=n}],[/^with up to \d{1,} characters$/i,(t,e)=>{const n=parseInt(e.slice("with ".length-1,e.indexOf(" to")));return t.length>=n}],[/^greater than \d{1,}/i,(t,e)=>{return t>e.slice(e.lastIndexOf(" ")+1)}],[/^greater than or equal to \d{1,}/i,(t,e)=>{return t>e.slice(e.lastIndexOf(" ")+1)}],[/^less than \d{1,}/i,(t,e)=>{return t<e.slice(e.lastIndexOf(" ")+1)}],[/^less than or equalt to \d{1,}/i,(t,e)=>{return t<=e.slice(e.lastIndexOf(" ")+1)}],[/^(and )?matches \/.{1,}\/[i,g]$/i,(t,e)=>{const n=e.slice(e.indexOf("/")+1,e.length-"/*".length),r=e.slice(-1);return!i.Null(t.match(new RegExp(n,r)))}]],a=(t,e,n)=>{var i=!0,s=!1,a=void 0;try{for(var u,c=Object.values(r({},o))[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){let t=u.value;if(t[0].test(n)){return(0,t[1])(e,n)}}}catch(t){s=!0,a=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw a}}};class u extends Error{constructor(t,e){super(t),this.name=e}}e.ValidationError=u;class c extends Error{constructor(t,e){super(t),this.name=e}}e.FormatError=c;const l=(t,e)=>{const n=`'${t}' must be ${e.join(", ")}`;throw new u(n,t)},f=t=>{throw new c(`[EnforceJS] Format for parameter '${t}' is invalid`,t)},h=(t,...e)=>{const n=Object.keys(e[0])[0],r=Object.values(e[0])[0],o=t[1].trim().replace("as ","").split(",").map(t=>t.trim());if(3===t.length){("a"!==o[0]&&"an"!==o[0]||1===e.length)&&f(n);const t=[[o[0],Object.keys(e[1])[0]].join(" ")],s=Object.values(e[1])[0];return i.Class(r,s)?void 0:l(n,t)}const u=s[o[0]];if(i.Void(u)&&f(n),u(r)||l(n,o),!i.Void(r))for(let t=1;t<o.length;t++){let e=o[t],u=s[e];if(i.Void(u)){const t=a(0,r,e);i.Void(t)&&f(n),!1===t&&l(n,o)}}};h.extend=((t,e)=>{o.push([t,e])}),e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toCamelCase=function(t){return t.replace(/_\w/g,function(t){return t[1].toUpperCase()})},e.toPascalCase=function(t){return t=(t=e.toCamelCase(t))[0].toUpperCase()+t.slice(1)},e.toDatabaseDate=function(t){return new Date(t).toISOString().slice(0,19).replace("T"," ")},e.toISODate=function(t){return new Date(t+"+00:00").toISOString()},e.addToDate=function(t,e,n){var r=new Date(t),i=new Date(r);return{minute:function(){return i.setMinutes(i.getMinutes()+e)},minutes:function(){return i.setMinutes(i.getMinutes()+e)},hour:function(){return i.setHours(i.getHours()+e)},hours:function(){return i.setHours(i.getHours()+e)},day:function(){return i.setDate(i.getDate()+e)},days:function(){return i.setDate(i.getDate()+e)},month:function(){return i.setMonth(i.getMonth()+e)},months:function(){return i.setMonth(i.getMonth()+e)},year:function(){return i.setFullYear(i.getFullYear()+e)},years:function(){return i.setFullYear(i.getFullYear()+e)}}[n](),i},e.toDateTime=function(t){return t?new Date(t):new Date}},function(t,e,n){"use strict";var r=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u,c,l,f=a(n(2)),h=a(n(0)),p=n(1),d=a(n(6)),y=n(3),_=n(23),v=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this._keyMap=new d.default,this._isDirty=!1,t.length>0){if("string"==typeof t[0]){if(void 0!==this.className)throw new h.default(h.default.Code.ForbiddenOperation,"A className has already been defined for the Warp Object");if(this._className=t[0],t.length>1&&"object"==typeof t[1]&&null!==t[1]){var n=t[1];this._setKeys(n),this._isDirty=!0}}else if("object"==typeof t[0]&&null!==t[1]){if(void 0===this.className)throw new h.default(h.default.Code.MissingConfiguration,"Only extended Warp Objects can have keys as the first argument");n=t[0];this._setKeys(n),this._isDirty=!0}}else if(void 0===this.className)throw new h.default(h.default.Code.MissingConfiguration,"The parameters for Warp Object are invalid")}return t.initialize=function(t,e,n){return this._http=t,this._storage=e,this._supportLegacy=n,this},t.createWithoutData=function(t,e){var n=new this(e);return n._id=t,n},t.toObject=function(t){var e=t.id,n=t.attributes,r=this.createWithoutData(e);return void 0!==n&&(r._keyMap=new d.default(n)),r},t.pointerIsImplementedBy=function(t){return null!==t&&("object"==typeof t&&("Pointer"===t.type&&!(t.id<=0)))},t.specialsIsImplementedBy=function(t){return null!==t&&("object"==typeof t&&void 0!==t.type)},t.prototype.statics=function(){return this.constructor},Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),t.prototype._setKeys=function(t){for(var e in t)this.set(e,t[e])},t.prototype.set=function(e,n){if(p.InternalKeys.Id===e||p.InternalKeys.Timestamps.CreatedAt===e||p.InternalKeys.Timestamps.UpdatedAt===e||p.InternalKeys.Timestamps.DeletedAt===e)throw new h.default(h.default.Code.ForbiddenOperation,"Cannot manually set `"+e+"` because it is an internal key");if("object"==typeof n&&null!==n&&n instanceof t){if(n.id<=0)throw new h.default(h.default.Code.ForbiddenOperation,"Cannot set `"+e+"` as a pointer because it is unsaved, please save it before using");this._keyMap.set(e,n.toPointer().toJSON())}else n instanceof Date?this._keyMap.set(e,y.toDatabaseDate(n.toISOString())):this._keyMap.set(e,n);this._isDirty=!0},t.prototype.get=function(t){if(p.InternalKeys.Id===t||p.InternalKeys.Timestamps.CreatedAt===t||p.InternalKeys.Timestamps.UpdatedAt===t||p.InternalKeys.Timestamps.DeletedAt===t)throw new h.default(h.default.Code.ForbiddenOperation,"Cannot manually get `"+t+"` because it is an internal key");var e=this._keyMap.get(t);return this.statics().pointerIsImplementedBy(e)?this.statics().toObject(e):this.statics().specialsIsImplementedBy(e)?void 0:e},t.prototype.increment=function(t,e){f.default(u||(u=r([""," as a number"],[""," as a number"])),{value:e});var n={type:"Increment",value:e};this._keyMap.set(t,n)},t.prototype.json=function(t){var e=this._keyMap;return{set:function(n,i){f.default(c||(c=r([""," as a string"],[""," as a string"])),{path:n});var s={type:"SetJson",path:n,value:i};e.set(t,s)},append:function(n,i){f.default(l||(l=r([""," as a string"],[""," as a string"])),{path:n});var s={type:"AppendJson",path:n,value:i};e.set(t,s)}}},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._keyMap.get(p.InternalKeys.Timestamps.CreatedAt)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updatedAt",{get:function(){return this._keyMap.get(p.InternalKeys.Timestamps.UpdatedAt)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deletedAt",{get:function(){return this._keyMap.get(p.InternalKeys.Timestamps.DeletedAt)},enumerable:!0,configurable:!0}),t.prototype.save=function(){return s(this,void 0,void 0,function(){var t,e,n,r,i,s;return o(this,function(o){switch(o.label){case 0:return this._isDirty?(t=this.statics()._storage.get(p.InternalKeys.Auth.SessionToken),e=this.className,n=this._keyMap.toJSON(),r=this.id,[4,this.statics()._http.save({sessionToken:t,className:e,keys:n,id:r})]):[2,this];case 1:return i=o.sent(),(s=new d.default(i)).remove(p.InternalKeys.Id),this._keyMap=s,this._isDirty=!1,[2,this]}})})},t.prototype.destroy=function(){return s(this,void 0,void 0,function(){var t,e,n,r,i;return o(this,function(s){switch(s.label){case 0:if(t=this.statics()._storage.get(p.InternalKeys.Auth.SessionToken),e=this.className,void 0===(n=this.id))throw new h.default(h.default.Code.ForbiddenOperation,"Cannot destroy an unsaved object");return[4,this.statics()._http.destroy({sessionToken:t,className:e,id:n})];case 1:return r=s.sent(),(i=new d.default(r)).remove(p.InternalKeys.Id),this._keyMap=i,this._isDirty=!1,[2,this]}})})},t.prototype.fetch=function(){return s(this,void 0,void 0,function(){var t,e,n,r,i;return o(this,function(s){switch(s.label){case 0:return t=this.statics()._storage.get("sessionToken"),e=this.className,n=this.id,[4,this.statics()._http.get({sessionToken:t,className:e,id:n})];case 1:return r=s.sent(),(i=new d.default(r)).remove(p.InternalKeys.Id),this._keyMap=i,[2,this]}})})},t.prototype.toPointer=function(){return this._isPointer=!0,this},t.prototype.toJSON=function(){var t,e,n,r=this.id,s=this.createdAt,o=this.updatedAt,a={};if(this._isPointer)(t={type:"Pointer"})[this.statics()._supportLegacy?p.InternalKeys.Pointers.LegacyClassName:p.InternalKeys.Pointers.ClassName]=this.className,a=t;else for(var u=0,c=this._keyMap.getAliases();u<c.length;u++){var l=c[u];if(p.InternalKeys.Timestamps.CreatedAt!==l&&p.InternalKeys.Timestamps.UpdatedAt!==l&&p.InternalKeys.Timestamps.DeletedAt!==l){var f=_.getPropertyDescriptor(this,y.toCamelCase(l));if(f&&"function"==typeof f.get){var h=f.get.bind(this);a[l]=h()}else a[l]=this.get(l)}}return i(((e={})[p.InternalKeys.Id]=r,e),a,((n={})[p.InternalKeys.Timestamps.CreatedAt]=s,n[p.InternalKeys.Timestamps.UpdatedAt]=o,n))},t._supportLegacy=!1,t}();e.default=v},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=s(n(0)),a=function(){function t(t,e,n){this._requestInterval=200,this._requests=0,this._maxRequests=t,this._requestInterval=e,this._timeout=n}return t.prototype._sleep=function(){var t=this;return new Promise(function(e){return setTimeout(e,t._requestInterval)})},t.prototype.push=function(t){return r(this,void 0,void 0,function(){var e=this;return i(this,function(n){switch(n.label){case 0:return this._requests>=this._maxRequests?[4,this._sleep()]:[3,2];case 1:return n.sent(),[3,0];case 2:return this._requests++,[4,new Promise(function(n,r){var i=!1,s=!1;t.then(function(t){if(!i)return s=!0,e._requests--,n(t)}).catch(function(t){i||(e._requests--,s=!0,r(t))}),setTimeout(function(){s||(i=!0,r(new o.default(o.default.Code.InternalServerError,"Request timed out")))},1e3*e._timeout)})];case 3:return[2,n.sent()]}})})},t}();e.default=a},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(0)),s=function(){function t(t,e,n){void 0===n&&(n=t),this._key=t,this._value=e,this._alias=n}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alias",{get:function(){return this._alias},set:function(t){this._alias=t},enumerable:!0,configurable:!0}),t}();e.KeyValuePair=s;var o=function(){function t(t,e){for(var n in void 0===t&&(t={}),void 0===e&&(e=!1),this._map={},t){var r=t[n],i=new s(n,r);this._map[n]=i}this._immutable=e}return t.prototype.set=function(t,e){if(this._immutable)throw new i.default(i.default.Code.ForbiddenOperation,"Cannot set a value for an immutable KeyMap");void 0===this._map[t]?this._map[t]=new s(t,e):this._map[t].value=e},t.prototype.setAlias=function(t,e){if(this._immutable)throw new i.default(i.default.Code.ForbiddenOperation,"Cannot set an alias for an immutable KeyMap");this._map[t].alias=e},t.prototype.remove=function(t){if(this._immutable)throw new i.default(i.default.Code.ForbiddenOperation,"Cannot remove from an immutable KeyMap");delete this._map[t]},t.prototype.get=function(t){return void 0===this._map[t]&&(this._map[t]=new s(t,void 0)),this._map[t].value},t.prototype.getAlias=function(t){return this._map[t].alias},t.prototype.getKeys=function(){return Object.keys(this._map)},t.prototype.has=function(t){return void 0!==this._map[t]},t.prototype.toList=function(){var t=this;return this.getKeys().map(function(e){return t._map[e]})},t.prototype.getAliases=function(){return this.toList().map(function(t){return t.alias})},t.prototype.setImmutability=function(t){this._immutable=t},t.prototype.toJSON=function(){var t=this.toList().reduce(function(t,e){return t[e.key]=e.value,t},{});return this._immutable?Object.freeze(t):t},t}();e.default=o},function(t,e,n){"use strict";var r,i=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},s=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=o(n(2)),u=o(n(4)),c=o(n(22)),l=o(n(19)),f=o(n(18)),h=o(n(17)),p=o(n(11)),d=o(n(0)),y=n(1),_=function(){function t(t){var e=t.platform,n=void 0===e?"browser":e,r=t.apiKey,o=t.masterKey,_=t.serverURL,w=t.api,O=t.sessionToken,k=t.currentUser,I=t.timeout,C=void 0===I?10:I,j=t.maxRequests,T=void 0===j?6:j,S=t.supportLegacy,K=void 0!==S&&S;if("browser"===n){if(a.default(v||(v=i([""," as a string"],[""," as a string"])),{apiKey:r}),a.default(b||(b=i([""," as an optional string"],[""," as an optional string"])),{apiKey:r}),a.default(m||(m=i([""," as an optional number"],[""," as an optional number"])),{timeout:C}),a.default(g||(g=i([""," as an optional number"],[""," as an optional number"])),{maxRequests:T}),"string"!=typeof _)throw new d.default(d.default.Code.MissingConfiguration,"`serverURL` must be a string");"/"===_[_.length-1]&&(_=_.slice(0,_.length-2)),this._http=h.default.use("browser",{apiKey:r,masterKey:o,serverURL:_,timeout:C,maxRequests:T}),this._storage=p.default.use("browser",{prefix:_})}if("api"===n){if(void 0===w)throw new d.default(d.default.Code.MissingConfiguration,"`api` must be provided when using the api platform");this._http=h.default.use("api",{api:w,sessionToken:O,currentUser:k}),this._storage=p.default.use("api",{prefix:w.apiKey}),void 0!==O&&this._storage.set(y.InternalKeys.Auth.SessionToken,O),void 0!==k&&this._storage.set(y.InternalKeys.Auth.User,JSON.stringify(k.toJSON()))}this._supportLegacy=K;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(u.default);this._object=P.initialize(this._http,this._storage,this._supportLegacy);var N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(c.default);this._query=N.initialize(this._http,this._storage);var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(l.default);this._user=x.initialize(this._http,this._storage,this._supportLegacy);var U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(f.default);this._function=U.initialize(this._http,this._storage)}return Object.defineProperty(t.prototype,"Object",{get:function(){return this._object},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Query",{get:function(){return this._query},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"User",{get:function(){return this._user},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Collection",{get:function(){return this._collection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Function",{get:function(){return this._function},enumerable:!0,configurable:!0}),t}();e.Warp=_;var v,b,m,g,w=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){if(void 0===this._instance)throw new d.default(d.default.Code.MissingConfiguration,"Warp must be initialized before it is used");return this._instance},enumerable:!0,configurable:!0}),t.initialize=function(t){this._instance=new _(t)},Object.defineProperty(t,"Object",{get:function(){return this.instance.Object},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Query",{get:function(){return this.instance.Query},enumerable:!0,configurable:!0}),Object.defineProperty(t,"User",{get:function(){return this.instance.User},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Collection",{get:function(){return this.instance.Collection},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Function",{get:function(){return this.instance.Function},enumerable:!0,configurable:!0}),t.extend=function(t){return new _(t)},t}();e.default=w,"undefined"!=typeof window&&(window.Warp=w)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._client={};var e=t.prefix;this._prefix=e}return t.prototype._getKey=function(t){return this._prefix+":"+t},t.prototype.set=function(t,e){this._client[this._getKey(t)]=e},t.prototype.get=function(t){var e=this._client[this._getKey(t)];if(null!==e)return e},t.prototype.remove=function(t){delete this._client[this._getKey(t)]},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._client={};var e=t.prefix;this._prefix=e}return t.prototype._getKey=function(t){return this._prefix+":"+t},t.prototype.set=function(t,e){this._client[this._getKey(t)]=e},t.prototype.get=function(t){var e=this._client[this._getKey(t)];if(null!==e)return e},t.prototype.remove=function(t){delete this._client[this._getKey(t)]},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this._client=localStorage;var e=t.prefix;this._prefix=e}return t.prototype._getKey=function(t){return this._prefix+":"+t},t.prototype.set=function(t,e){void 0!==e&&this._client.setItem(this._getKey(t),e)},t.prototype.get=function(t){var e=this._client.getItem(this._getKey(t));if(null!==e)return e},t.prototype.remove=function(t){this._client.removeItem(this._getKey(t))},t}();e.default=r},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(0)),s=r(n(10)),o=r(n(9)),a=r(n(8)),u=function(){function t(){}return t.use=function(t,e){var n=this.Platform[t];if(void 0===n)throw new i.default(i.default.Code.MissingConfiguration,"Storage `"+t+"` is not supported");return new n(e)},t.Platform=Object.freeze({browser:s.default,api:o.default,node:a.default}),t}();e.default=u},function(t,e){t.exports=e=window.fetch,e.default=window.fetch.bind(window),e.Headers=window.Headers,e.Request=window.Request,e.Response=window.Response},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=s(n(12)),a=s(n(0)),u=s(n(5)),c=n(1),l=function(){function t(t){this._requestInterval=200;var e=t.apiKey,n=t.masterKey,r=t.serverURL,i=t.timeout,s=t.maxRequests;this._apiKey=e||"",this._masterKey=n,this._serverURL=r||"",this._queue=new u.default(s||6,this._requestInterval,i||10)}return t.prototype.logIn=function(t){var e=t.username,n=t.email,s=t.password;return r(this,void 0,void 0,function(){var t,r,o;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/login",r={username:e,email:n,password:s},o=this._send(t,"POST",void 0,r),[4,this._queue.push(o)];case 1:return[2,i.sent()]}})})},t.prototype.become=function(t){var e=t.sessionToken;return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:return t=this._serverURL+"/users/me",n=this._send(t,"GET",e),[4,this._queue.push(n)];case 1:return[2,r.sent()]}})})},t.prototype.logOut=function(t){var e=t.sessionToken;return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:return t=this._serverURL+"/logout",n=this._send(t,"POST",e),[4,this._queue.push(n)];case 1:return[2,r.sent()]}})})},t.prototype.find=function(t){var e=t.className,n=t.select,s=t.include,o=t.where,a=t.sort,u=t.skip,l=t.limit;return r(this,void 0,void 0,function(){var t,r,f;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+e+"?",r=[],e===c.InternalKeys.Auth.User?t=this._serverURL+"/users?":e===c.InternalKeys.Auth.Session&&(t=this._serverURL+"/sessions?"),void 0!==n&&r.push("select="+encodeURIComponent(JSON.stringify(n))),void 0!==s&&r.push("include="+encodeURIComponent(JSON.stringify(s))),void 0!==o&&r.push("where="+encodeURIComponent(JSON.stringify(o))),void 0!==a&&r.push("sort="+encodeURIComponent(JSON.stringify(a))),void 0!==u&&r.push("skip="+u),void 0!==l&&r.push("limit="+l),t+=r.join("&"),f=this._send(t,"GET"),[4,this._queue.push(f)];case 1:return[2,i.sent()]}})})},t.prototype.get=function(t){var e=t.className,n=t.id,s=t.select,o=t.include;return r(this,void 0,void 0,function(){var t,r,a;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+e+"/"+n+"?",r=[],e===c.InternalKeys.Auth.User?t=this._serverURL+"/users/"+n+"?":e===c.InternalKeys.Auth.Session&&(t=this._serverURL+"/sessions/"+n+"?"),void 0!==s&&r.push("select="+encodeURIComponent(JSON.stringify(s))),void 0!==o&&r.push("include="+encodeURIComponent(JSON.stringify(o))),t+=r.join("&"),a=this._send(t,"GET"),[4,this._queue.push(a)];case 1:return[2,i.sent()]}})})},t.prototype.save=function(t){var e=t.sessionToken,n=t.className,s=t.keys,o=t.id;return r(this,void 0,void 0,function(){var t,r,a;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+n,n===c.InternalKeys.Auth.User&&(t=this._serverURL+"/users"),void 0!==o&&(t+="/"+o),r=void 0===o?"POST":"PUT",a=this._send(t,r,e,s),[4,this._queue.push(a)];case 1:return[2,i.sent()]}})})},t.prototype.destroy=function(t){var e=t.sessionToken,n=t.className,s=t.id;return r(this,void 0,void 0,function(){var t,r;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+n+"/"+s,n===c.InternalKeys.Auth.User&&(t=this._serverURL+"/users"),r=this._send(t,"DELETE",e),[4,this._queue.push(r)];case 1:return[2,i.sent()]}})})},t.prototype.run=function(t){var e=t.sessionToken,n=t.functionName,s=t.keys;return r(this,void 0,void 0,function(){var t,r;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/functions/"+n,r=this._send(t,"POST",e,s),[4,this._queue.push(r)];case 1:return[2,i.sent()]}})})},t.prototype._send=function(t,e,n,s){return r(this,void 0,void 0,function(){var r,u,c,l;return i(this,function(i){switch(i.label){case 0:return(r=new Headers).append("X-Warp-API-Key",this._apiKey),r.append("Content-Type","GET"===e?"application/x-www-form-urlencode":"application/json"),"string"==typeof this._masterKey&&r.append("X-Warp-Master-Key",this._masterKey),"string"==typeof n&&r.append("X-Warp-Session-Token",n),u={headers:r,method:e,body:s?JSON.stringify(s):void 0},[4,o.default(t,u)];case 1:return[4,(c=i.sent()).json()];case 2:if(l=i.sent(),c.status<200||c.status>=400)throw new a.default(l.code,l.message);return[2,l.result]}})})},t}();e.default=l},function(t){t.exports={name:"warp-sdk-js",version:"5.2.6",description:"Warp JavaScript SDK",main:"./dist/index.js",typings:"./typings/index.d.js",scripts:{build:"tsc",package:"webpack dist/index.js --output pack/index.js",clean:"node ./node_modules/rimraf/bin dist",test:"mocha --require babel-core/register",lint:"eslint src/**",prepublish:"npm run clean && npm run build && npm run package"},repository:{type:"git",url:"git+https://github.com/dividedbyzeroco/warp-sdk-js.git"},keywords:["warp","js"],author:"Warp",license:"MIT",bugs:{url:"https://github.com/dividedbyzeroco/warp-sdk-js/issues"},homepage:"https://github.com/dividedbyzeroco/warp-sdk-js#readme",dependencies:{"enforce-js":"^1.2.6","node-fetch":"^2.1.1",rimraf:"^2.6.2","warp-server":"^5.2.1"},devDependencies:{chai:"^4.1.2",eslint:"^4.16.0",mocha:"^5.0.1",nodemon:"^1.10.0",webpack:"^4.1.0","webpack-cli":"^2.0.10"}}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),a=s(n(0)),u=n(1),c=function(){function t(t){var e=t.api,n=t.sessionToken,r=t.currentUser;if(void 0===e)throw new a.default(a.default.Code.MissingConfiguration,"`api` must be provided for the api platform");this._api=e,this._sessionToken=n,this._currentUser=r}return Object.defineProperty(t.prototype,"metadata",{get:function(){return{client:"JavaScript",sdkVersion:n(14).version,isMaster:!0}},enumerable:!0,configurable:!0}),t.prototype.getWarp=function(t,e){var n=this._api.apiKey,r=this._api;return new o.Warp({platform:"api",apiKey:n,api:r,sessionToken:t,currentUser:e})},t.prototype.logIn=function(t){var e=t.username,n=t.email,s=t.password;return r(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return t=this.metadata,[4,this._api._userController.logIn({metadata:t,username:e,email:n,password:s})];case 1:return[2,r.sent().toJSON()]}})})},t.prototype.become=function(t){var e=t.sessionToken;return r(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return[4,this._getCurrentUser(e)];case 1:return t=n.sent(),[4,this._api._userController.me({currentUser:t})];case 2:return[2,n.sent().toJSON()]}})})},t.prototype.logOut=function(t){var e=t.sessionToken;return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:return[4,this._getCurrentUser(e)];case 1:return t=r.sent(),n=this.getWarp(e,t),[4,this._api._userController.logOut({Warp:n,sessionToken:e})];case 2:return[2,r.sent().toJSON()]}})})},t.prototype.find=function(t){var e=t.className,n=t.select,s=void 0===n?[]:n,o=t.include,a=void 0===o?[]:o,c=t.where,l=void 0===c?{}:c,f=t.sort,h=t.skip,p=void 0===h?0:h,d=t.limit,y=void 0===d?100:d;return r(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return e!==u.InternalKeys.Auth.User?[3,2]:[4,this._api._userController.find({select:s,include:a,where:l,sort:f,skip:p,limit:y})];case 1:return t=n.sent().toJSON(),[3,6];case 2:return e!==u.InternalKeys.Auth.Session?[3,4]:[4,this._api._sessionController.find({select:s,include:a,where:l,sort:f,skip:p,limit:y})];case 3:return t=n.sent().toJSON(),[3,6];case 4:return[4,this._api._classController.find({className:e,select:s,include:a,where:l,sort:f,skip:p,limit:y})];case 5:t=n.sent().toJSON(),n.label=6;case 6:return[2,t]}})})},t.prototype.get=function(t){var e=t.className,n=t.id,s=t.select,o=t.include;return r(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return e!==u.InternalKeys.Auth.User?[3,2]:[4,this._api._userController.get({select:s,include:o,id:n})];case 1:return t=r.sent().toJSON(),[3,6];case 2:return e!==u.InternalKeys.Auth.Session?[3,4]:[4,this._api._sessionController.get({select:s,include:o,id:n})];case 3:return t=r.sent().toJSON(),[3,6];case 4:return[4,this._api._classController.get({className:e,select:s,include:o,id:n})];case 5:t=r.sent().toJSON(),r.label=6;case 6:return[2,t]}})})},t.prototype.save=function(t){var e=t.sessionToken,n=t.className,s=t.keys,o=t.id;return r(this,void 0,void 0,function(){var t,r,a;return i(this,function(i){switch(i.label){case 0:return[4,this._getCurrentUser(e)];case 1:return t=i.sent(),r=this.metadata,void 0!==o?[3,6]:n!==u.InternalKeys.Auth.User?[3,3]:[4,this._api._userController.create({metadata:r,currentUser:t,keys:s})];case 2:return a=i.sent().toJSON(),[3,5];case 3:return[4,this._api._classController.create({metadata:r,currentUser:t,className:n,keys:s})];case 4:a=i.sent().toJSON(),i.label=5;case 5:return[3,10];case 6:return n!==u.InternalKeys.Auth.User?[3,8]:[4,this._api._userController.update({metadata:r,currentUser:t,keys:s,id:o})];case 7:return a=i.sent().toJSON(),[3,10];case 8:return[4,this._api._classController.update({metadata:r,currentUser:t,className:n,keys:s,id:o})];case 9:a=i.sent().toJSON(),i.label=10;case 10:return[2,a]}})})},t.prototype.destroy=function(t){var e=t.sessionToken,n=t.className,s=t.id;return r(this,void 0,void 0,function(){var t,r,o;return i(this,function(i){switch(i.label){case 0:return[4,this._getCurrentUser(e)];case 1:return t=i.sent(),r=this.metadata,n!==u.InternalKeys.Auth.User?[3,3]:[4,this._api._userController.destroy({metadata:r,currentUser:t,id:s})];case 2:return o=i.sent().toJSON(),[3,5];case 3:return[4,this._api._classController.destroy({metadata:r,currentUser:t,className:n,id:s})];case 4:o=i.sent().toJSON(),i.label=5;case 5:return[2,o]}})})},t.prototype.run=function(t){var e=t.sessionToken,n=t.functionName,s=t.keys;return r(this,void 0,void 0,function(){var t,r,o;return i(this,function(i){switch(i.label){case 0:return[4,this._getCurrentUser(e)];case 1:return t=i.sent(),r=this.metadata,o=this.getWarp(e,t),[4,this._api._functionController.run({Warp:o,metadata:r,currentUser:t,functionName:n,keys:s})];case 2:return[2,i.sent().toJSON()]}})})},t.prototype._getCurrentUser=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return this._sessionToken===t?[2,this._currentUser]:void 0===t?[3,2]:(this._sessionToken=t,e=this,[4,this._api.authenticate({sessionToken:t})]);case 1:e._currentUser=n.sent(),n.label=2;case 2:return[2,this._currentUser]}})})},t}();e.default=c},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=s(n(0)),a=s(n(5)),u=n(1),c=function(){function t(t){this._requestInterval=200;var e=t.apiKey,n=t.masterKey,r=t.serverURL,i=t.timeout,s=t.maxRequests;this._apiKey=e||"",this._masterKey=n,this._serverURL=r||"",this._queue=new a.default(s||6,this._requestInterval,i||10)}return t.prototype.logIn=function(t){var e=t.username,n=t.email,s=t.password;return r(this,void 0,void 0,function(){var t,r,o;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/login",r={username:e,email:n,password:s},o=this._send(t,"POST",void 0,r),[4,this._queue.push(o)];case 1:return[2,i.sent()]}})})},t.prototype.become=function(t){var e=t.sessionToken;return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:return t=this._serverURL+"/users/me",n=this._send(t,"GET",e),[4,this._queue.push(n)];case 1:return[2,r.sent()]}})})},t.prototype.logOut=function(t){var e=t.sessionToken;return r(this,void 0,void 0,function(){var t,n;return i(this,function(r){switch(r.label){case 0:return t=this._serverURL+"/logout",n=this._send(t,"POST",e),[4,this._queue.push(n)];case 1:return[2,r.sent()]}})})},t.prototype.find=function(t){var e=t.className,n=t.select,s=t.include,o=t.where,a=t.sort,c=t.skip,l=t.limit;return r(this,void 0,void 0,function(){var t,r,f;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+e+"?",r=[],e===u.InternalKeys.Auth.User?t=this._serverURL+"/users?":e===u.InternalKeys.Auth.Session&&(t=this._serverURL+"/sessions?"),void 0!==n&&r.push("select="+encodeURIComponent(JSON.stringify(n))),void 0!==s&&r.push("include="+encodeURIComponent(JSON.stringify(s))),void 0!==o&&r.push("where="+encodeURIComponent(JSON.stringify(o))),void 0!==a&&r.push("sort="+encodeURIComponent(JSON.stringify(a))),void 0!==c&&r.push("skip="+c),void 0!==l&&r.push("limit="+l),t+=r.join("&"),f=this._send(t,"GET"),[4,this._queue.push(f)];case 1:return[2,i.sent()]}})})},t.prototype.get=function(t){var e=t.className,n=t.id,s=t.select,o=t.include;return r(this,void 0,void 0,function(){var t,r,a;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+e+"/"+n+"?",r=[],e===u.InternalKeys.Auth.User?t=this._serverURL+"/users/"+n+"?":e===u.InternalKeys.Auth.Session&&(t=this._serverURL+"/sessions/"+n+"?"),void 0!==s&&r.push("select="+encodeURIComponent(JSON.stringify(s))),void 0!==o&&r.push("include="+encodeURIComponent(JSON.stringify(o))),t+=r.join("&"),a=this._send(t,"GET"),[4,this._queue.push(a)];case 1:return[2,i.sent()]}})})},t.prototype.save=function(t){var e=t.sessionToken,n=t.className,s=t.keys,o=t.id;return r(this,void 0,void 0,function(){var t,r,a;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+n,n===u.InternalKeys.Auth.User&&(t=this._serverURL+"/users"),void 0!==o&&(t+="/"+o),r=void 0===o?"POST":"PUT",a=this._send(t,r,e,s),[4,this._queue.push(a)];case 1:return[2,i.sent()]}})})},t.prototype.destroy=function(t){var e=t.sessionToken,n=t.className,s=t.id;return r(this,void 0,void 0,function(){var t,r;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/classes/"+n+"/"+s,n===u.InternalKeys.Auth.User&&(t=this._serverURL+"/users"),r=this._send(t,"DELETE",e),[4,this._queue.push(r)];case 1:return[2,i.sent()]}})})},t.prototype.run=function(t){var e=t.sessionToken,n=t.functionName,s=t.keys;return r(this,void 0,void 0,function(){var t,r;return i(this,function(i){switch(i.label){case 0:return t=this._serverURL+"/functions/"+n,r=this._send(t,"POST",e,s),[4,this._queue.push(r)];case 1:return[2,i.sent()]}})})},t.prototype._send=function(t,e,n,s){return r(this,void 0,void 0,function(){var r,a,u,c;return i(this,function(i){switch(i.label){case 0:return(r=new Headers).append("X-Warp-API-Key",this._apiKey),r.append("Content-Type","GET"===e?"application/x-www-form-urlencode":"application/json"),"string"==typeof this._masterKey&&r.append("X-Warp-Master-Key",this._masterKey),"string"==typeof n&&r.append("X-Warp-Session-Token",n),a={headers:r,method:e,body:s?JSON.stringify(s):void 0},[4,fetch(t,a)];case 1:return[4,(u=i.sent()).json()];case 2:if(c=i.sent(),u.status<200||u.status>=400)throw new o.default(c.code,c.message);return[2,c.result]}})})},t}();e.default=c},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(0)),s=r(n(16)),o=r(n(15)),a=r(n(13)),u=function(){function t(){}return t.use=function(t,e){var n=this.Platform[t];if(void 0===n)throw new i.default(i.default.Code.MissingConfiguration,"Http `"+t+"` is not supported");return new n(e)},t.Platform=Object.freeze({browser:s.default,api:o.default,node:a.default}),t}();e.default=u},function(t,e,n){"use strict";var r=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a,u,c=o(n(2)),l=n(1),f=function(){function t(){}return t.initialize=function(t,e){return this._http=t,this._storage=e,this},t.run=function(t,e,n){return i(this,void 0,void 0,function(){var i,o;return s(this,function(s){switch(s.label){case 0:return c.default(a||(a=r([""," as a string"],[""," as a string"])),{functionName:t}),c.default(u||(u=r([""," as an optional object"],[""," as an optional object"])),{keys:e}),i=this._storage.get(l.InternalKeys.Auth.SessionToken),[4,this._http.run({sessionToken:i,functionName:t,keys:e})];case 1:return o=s.sent(),"function"!=typeof n?[3,3]:[4,n(o)];case 2:return[2,s.sent()];case 3:return[2,o]}})})},t}();e.default=f},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=a(n(4)),c=a(n(0)),l=n(3),f=n(1),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e._clearSession=function(){this._storage.remove(f.InternalKeys.Auth.SessionToken),this._storage.remove(f.InternalKeys.Auth.RevokedAt),this._storage.remove(f.InternalKeys.Auth.User),this._currentUser=void 0},e.current=function(){if(void 0===this._currentUser){var t=this._storage.get(f.InternalKeys.Auth.RevokedAt),e=this._storage.get(f.InternalKeys.Auth.User);if(l.toDateTime(t).getTime()<l.toDateTime().getTime())throw this._clearSession(),new c.default(c.default.Code.InvalidSessionToken,"Session expired. Try logging in again.");if(void 0!==e)try{var n=JSON.parse(e),r=n[f.InternalKeys.Id];delete n[f.InternalKeys.Id];var i=new this(n);i._id=r,i._isDirty=!1,this._currentUser=i}catch(t){throw new c.default(c.default.Code.ForbiddenOperation,"Current user data is malformed. Try logging out or clearing browser cache.")}}return this._currentUser},e.logIn=function(t){return s(this,void 0,void 0,function(){var e,n,r;return o(this,function(i){switch(i.label){case 0:return[4,this._http.logIn(t)];case 1:return e=i.sent(),n=e[f.InternalKeys.Auth.SessionToken],r=e[f.InternalKeys.Auth.RevokedAt],[4,this.become({sessionToken:n,revokedAt:r})];case 2:return[2,i.sent()]}})})},e.become=function(t){var e=t.sessionToken,n=t.revokedAt;return s(this,void 0,void 0,function(){var t,r,i;return o(this,function(s){switch(s.label){case 0:return[4,this._http.become({sessionToken:e})];case 1:if(t=s.sent(),r=n?new Date(n).toISOString():(new Date).toISOString(),this._storage.set(f.InternalKeys.Auth.SessionToken,e),this._storage.set(f.InternalKeys.Auth.RevokedAt,r),this._storage.set(f.InternalKeys.Auth.User,JSON.stringify(t)),void 0===(i=this.current()))throw new c.default(c.default.Code.InvalidSessionToken,"Invalid session token");return[2,i]}})})},e.logOut=function(t){var e=t.sessionToken;return s(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this._http.logOut({sessionToken:e})];case 1:return t.sent(),this._clearSession(),[2]}})})},Object.defineProperty(e,"usernameKey",{get:function(){return f.InternalKeys.Auth.Username},enumerable:!0,configurable:!0}),Object.defineProperty(e,"emailKey",{get:function(){return f.InternalKeys.Auth.Email},enumerable:!0,configurable:!0}),Object.defineProperty(e,"passwordKey",{get:function(){return f.InternalKeys.Auth.Password},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return f.InternalKeys.Auth.User},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"username",{get:function(){return this.get(this.statics().usernameKey)},set:function(t){this.set(this.statics().usernameKey,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"email",{get:function(){return this.get(this.statics().emailKey)},set:function(t){this.set(this.statics().emailKey,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"password",{set:function(t){this.set(this.statics().passwordKey,t)},enumerable:!0,configurable:!0}),e}(u.default);e.default=h},function(t,e,n){"use strict";var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=i(n(0)),o=function(){function t(t,e){this._key=t,this._map=e}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){var t=this;return Object.keys(this._map).map(function(e){return{key:t.key,constraint:e,value:t._map[e]}})},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){this._map[t]=e},t.prototype.changeKey=function(t){this._key=t},t.prototype.constraintExists=function(t){return void 0!==this._map[t]},t.prototype.toJSON=function(){return Object.freeze(r({},this._map))},t}();e.KeyConstraints=o,e.Constraints=Object.freeze({EqualTo:"eq",NotEqualTo:"neq",GreaterThan:"gt",GreaterThanOrEqualTo:"gte",LessThan:"lt",LessThanOrEqualTo:"lte",Exists:"ex",ContainedIn:"in",NotContainedIn:"nin",ContainedInOrDoesNotExist:"inx",StartsWith:"str",EndsWith:"end",Contains:"has",ContainsEither:"hasi",ContainsAll:"hasa",FoundIn:"fi",FoundInEither:"fie",FoundInAll:"fia",NotFoundIn:"nfi",NotFoundInEither:"nfe"}),e.Subqueries=Object.freeze({FoundIn:"fi",FoundInEither:"fie",FoundInAll:"fia",NotFoundIn:"nfi",NotFoundInEither:"nfe"});var a=function(){function t(t){for(var e in void 0===t&&(t={}),this._map={},t)this._map[e]=new o(e,t[e])}return Object.defineProperty(t,"Constraints",{get:function(){return e.Constraints},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Subqueries",{get:function(){return e.Subqueries},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e,n){var r=this._map[t]||new o(t,{});r.set(e,n),this._map[t]=r},t.prototype.changeKey=function(t,e){var n=this._map[t];if(!n)throw new s.default(s.default.Code.MissingConfiguration,"Constraint key being changed does not exist: `"+t+"`");n.changeKey(e),this._map[e]=n,delete this._map[t]},t.prototype.get=function(t){return this._map[t]},t.prototype.getKeys=function(){return Object.keys(this._map)},t.prototype.getConstraints=function(t){return this._map[t].list},t.prototype.equalTo=function(t,n){this.set(t,e.Constraints.EqualTo,n)},t.prototype.notEqualTo=function(t,n){this.set(t,e.Constraints.NotEqualTo,n)},t.prototype.greaterThan=function(t,n){this.set(t,e.Constraints.GreaterThan,n)},t.prototype.greaterThanOrEqualTo=function(t,n){this.set(t,e.Constraints.GreaterThanOrEqualTo,n)},t.prototype.lessThan=function(t,n){this.set(t,e.Constraints.LessThan,n)},t.prototype.lessThanOrEqualTo=function(t,n){this.set(t,e.Constraints.LessThanOrEqualTo,n)},t.prototype.exists=function(t){this.set(t,e.Constraints.Exists,!0)},t.prototype.doesNotExist=function(t){this.set(t,e.Constraints.Exists,!1)},t.prototype.containedIn=function(t,n){this.set(t,e.Constraints.ContainedIn,n)},t.prototype.notContainedIn=function(t,n){this.set(t,e.Constraints.NotContainedIn,n)},t.prototype.containedInOrDoesNotExist=function(t,n){this.set(t,e.Constraints.ContainedInOrDoesNotExist,n)},t.prototype.startsWith=function(t,n){this.set(t,e.Constraints.StartsWith,n)},t.prototype.endsWith=function(t,n){this.set(t,e.Constraints.EndsWith,n)},t.prototype.contains=function(t,n){this.set(t,e.Constraints.Contains,n)},t.prototype.containsEither=function(t,n){this.set(t,e.Constraints.ContainsEither,n)},t.prototype.containsAll=function(t,n){this.set(t,e.Constraints.ContainsAll,n)},t.prototype.foundIn=function(t,n){this.set(t,e.Constraints.FoundIn,n)},t.prototype.foundInEither=function(t,n){this.set(t,e.Constraints.FoundInEither,n)},t.prototype.foundInAll=function(t,n){this.set(t,e.Constraints.FoundInAll,n)},t.prototype.notFoundIn=function(t,n){this.set(t,e.Constraints.NotFoundIn,n)},t.prototype.notFoundInEither=function(t,n){this.set(t,e.Constraints.NotFoundInEither,n)},t.prototype.toList=function(){var t=this;return Object.keys(this._map).map(function(e){return t._map[e]})},t.prototype.toJSON=function(){var t=this;return Object.keys(this._map).reduce(function(e,n){return e[n]=t._map[n].toJSON(),e},{})},t}();e.default=a},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t){this._objects=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.count()},enumerable:!0,configurable:!0}),t.prototype.count=function(){return this._objects.length},t.prototype.first=function(){return this._objects.length>0?this._objects[0]:null},t.prototype.last=function(){return this._objects.length>0?this._objects[this._objects.length-1]:null},t.prototype.where=function(t){for(var e=[],n=0,r=this._objects.slice();n<r.length;n++){var i=r[n];t(i)&&e.push(i)}return new(0,this.constructor)(e)},t.prototype.map=function(t){for(var e=[],n=0,r=this._objects.slice();n<r.length;n++){var i=r[n];e.push(t(i))}return e},t.prototype.forEach=function(t){for(var e=0,n=this._objects.slice();e<n.length;e++){t(n[e])}},t.prototype.toList=function(){return this.toArray()},t.prototype.toArray=function(){return this.map(function(t){return t})},t.prototype.each=function(t){return r(this,void 0,void 0,function(){var e,n,r,s;return i(this,function(i){switch(i.label){case 0:e=this._objects.slice(),n=0,r=e,i.label=1;case 1:return n<r.length?(s=r[n],[4,t(s)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.all=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return e=this.map(function(e){return t(e)}),[4,Promise.all(e)];case 1:return n.sent(),[2]}})})},t.prototype[Symbol.iterator]=function(){var t=this,e=0;return{next:function(){return t._objects.length===e?(e=0,{value:void 0,done:!0}):{value:t._objects[e++],done:!1}}}},t}();e.default=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&s[0]?"return":s[0]?"throw":"next"])&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[0,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var c,l,f,h,p,d,y,_=u(n(2)),v=u(n(4)),b=u(n(0)),m=u(n(6)),g=u(n(21)),w=n(1),O=n(3),k=u(n(20)),I=function(){function t(t){if(this._select=[],this._include=[],this._where=new k.default,this._sort=[],"string"==typeof t){var e=t;this._class=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),Object.defineProperty(n.prototype,"className",{get:function(){return e},enumerable:!0,configurable:!0}),n}(v.default)}else{if(!(new t instanceof v.default))throw new b.default(b.default.Code.ForbiddenOperation,"`className` must be a string or a `Warp.Object`");this._class=t}}return t.initialize=function(t,e){return this._http=t,this._storage=e,this},t.prototype.statics=function(){return this.constructor},t.prototype._set=function(t,e,n){return _.default(c||(c=s([""," as a string"],[""," as a string"])),{key:t}),n instanceof Date&&(n=O.toDatabaseDate(n.toISOString())),this._where.set(t,e,n),this},t.prototype.equalTo=function(t,e){return this._set(t,k.Constraints.EqualTo,e),this},t.prototype.notEqualTo=function(t,e){return this._set(t,k.Constraints.NotEqualTo,e),this},t.prototype.greaterThan=function(t,e){return this._set(t,k.Constraints.GreaterThan,e),this},t.prototype.greaterThanOrEqualTo=function(t,e){return this._set(t,k.Constraints.GreaterThanOrEqualTo,e),this},t.prototype.lessThan=function(t,e){return this._set(t,k.Constraints.LessThan,e),this},t.prototype.lessThanOrEqualTo=function(t,e){return this._set(t,k.Constraints.LessThanOrEqualTo,e),this},t.prototype.exists=function(t){return this._set(t,k.Constraints.Exists,!0),this},t.prototype.doesNotExist=function(t){return this._set(t,k.Constraints.Exists,!1),this},t.prototype.containedIn=function(t,e){return this._set(t,k.Constraints.ContainedIn,e),this},t.prototype.notContainedIn=function(t,e){return this._set(t,k.Constraints.NotContainedIn,e),this},t.prototype.containedInOrDoesNotExist=function(t,e){return this._set(t,k.Constraints.ContainedInOrDoesNotExist,e),this},t.prototype.startsWith=function(t,e){return this._set(t,k.Constraints.StartsWith,e),this},t.prototype.endsWith=function(t,e){return this._set(t,k.Constraints.EndsWith,e),this},t.prototype.contains=function(t,e){return this._set(t,k.Constraints.Contains,e),this},t.prototype.containsEither=function(t,e){return this._set(t,k.Constraints.ContainsEither,e),this},t.prototype.containsAll=function(t,e){return this._set(t,k.Constraints.ContainsAll,e),this},t.prototype.foundIn=function(t,e,n){return this._set(t,k.Constraints.FoundIn,n.toSubquery(e)),this},t.prototype.foundInEither=function(t,e){return this._set(t,k.Constraints.FoundInEither,e.map(function(t){var e=Object.keys(t)[0];return t[e].toSubquery(e)})),this},t.prototype.foundInAll=function(t,e){return this._set(t,k.Constraints.FoundInAll,e.map(function(t){var e=Object.keys(t)[0];return t[e].toSubquery(e)})),this},t.prototype.notFoundIn=function(t,e,n){return this._set(t,k.Constraints.NotFoundIn,n.toSubquery(e)),this},t.prototype.notFoundInEither=function(t,e){return this._set(t,k.Constraints.NotFoundInEither,e.map(function(t){var e=Object.keys(t)[0];return t[e].toSubquery(e)})),this},t.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!t)throw new b.default(b.default.Code.MissingConfiguration,"Select key must be a string or an array of strings");for(var n=0,r=t[0]instanceof Array?t[0]:t;n<r.length;n++){var i=r[n];_.default(l||(l=s([""," as a string"],[""," as a string"])),{key:i}),this._select.push(i)}return this},t.prototype.include=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!t)throw new b.default(b.default.Code.MissingConfiguration,"Include key must be a string or an array of strings");for(var n=0,r=t[0]instanceof Array?t[0]:t;n<r.length;n++){var i=r[n];_.default(f||(f=s([""," as a string"],[""," as a string"])),{key:i}),this._include.push(i)}return this},t.prototype.sortBy=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!t)throw new b.default(b.default.Code.MissingConfiguration,"SortBy key must be a string or an array of strings");for(var n=0,r=t[0]instanceof Array?t[0]:t;n<r.length;n++){var i=r[n];_.default(h||(h=s([""," as a string"],[""," as a string"])),{key:i}),this._sort.push(i)}return this},t.prototype.sortByDescending=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!t)throw new b.default(b.default.Code.MissingConfiguration,"SortByDescending key must be a string or an array of strings");for(var n=0,r=t[0]instanceof Array?t[0]:t;n<r.length;n++){var i=r[n];_.default(p||(p=s([""," as a string"],[""," as a string"])),{key:i}),this._sort.push("-"+i)}return this},t.prototype.skip=function(t){return _.default(d||(d=s([""," as a number"],[""," as a number"])),{skip:t}),this._skip=t,this},t.prototype.limit=function(t){return _.default(y||(y=s([""," as a number"],[""," as a number"])),{limit:t}),this._limit=t,this},t.prototype.find=function(t){return o(this,void 0,void 0,function(){var e,n,r,i,s,o,u,c,l,f,h,p,d,y,_,v,b;return a(this,function(a){switch(a.label){case 0:return e=this.statics()._storage.get(w.InternalKeys.Auth.SessionToken),n=this._class.prototype.className,r=this._select.length>0?this._select:void 0,i=this._include.length>0?this._include:void 0,s=this._where.toJSON(),o=this._sort.length>0?this._sort:void 0,u=this._skip,c=this._limit,[4,this.statics()._http.find({sessionToken:e,className:n,select:r,include:i,where:s,sort:o,skip:u,limit:c})];case 1:for(l=a.sent(),f=[],h=0,p=l;h<p.length;h++)d=p[h],y=d[w.InternalKeys.Id],delete d[w.InternalKeys.Id],_=this._class,(v=new _)._id=y,v._keyMap=new m.default(d),v._isDirty=!1,f.push(v);return b=new g.default(f),"function"!=typeof t?[3,3]:[4,t(b)];case 2:return[2,a.sent()];case 3:return[2,b]}})})},t.prototype.first=function(t){return o(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:return this._skip=0,this._limit=1,[4,this.find()];case 1:return 0===(e=r.sent()).length?[2,null]:(n=e.first(),"function"!=typeof t?[3,3]:[4,t(n)]);case 2:return[2,r.sent()];case 3:return[2,n]}})})},t.prototype.get=function(t){return o(this,void 0,void 0,function(){var e,n,r,i,s,o,u;return a(this,function(a){switch(a.label){case 0:return e=this.statics()._storage.get(w.InternalKeys.Auth.SessionToken),n=this._class.prototype.className,r=this._select.length>0?this._select:void 0,i=this._include.length>0?this._include:void 0,[4,this.statics()._http.get({sessionToken:e,className:n,select:r,include:i,id:t})];case 1:return s=a.sent(),o=this._class,(u=new o)._id=t,u._keyMap=new m.default(s),u._isDirty=!1,[2,u]}})})},t.prototype.toSubquery=function(t){return{className:this._class.prototype.className,where:this._where.toJSON(),select:t}},t}();e.default=I},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getPropertyDescriptor=function(t,e){var n;do{n=Object.getOwnPropertyDescriptor(t,e)}while(!n&&(t=Object.getPrototypeOf(t)));return n}}]);